; jpeg_decoder_test.rgr - Test for JPEG decoder
; Reads a JPEG, scales it, and saves as PPM

Import "../jpeg/JPEGDecoder.rgr"

class JPEGDecoderTest {
    sfn m@(main):void () {
        print "=== Ranger JPEG Decoder Test ==="
        print ""
        
        def decoder (new JPEGDecoder())
        def img:ImageBuffer (decoder.decode("./gallery/pdf_writer" "Canon_40D.jpg"))
        
        print ""
        print ("Output image: " + (to_string img.width) + "x" + (to_string img.height))
        
        ; Scale image 3x larger
        def scaled:ImageBuffer (img.scale(3))
        print ("Scaled image: " + (to_string scaled.width) + "x" + (to_string scaled.height))
        
        ; Save as PPM
        def ppm (new PPMImage())
        ppm.save(scaled "./gallery/pdf_writer" "decoded_test.ppm")
        
        print ""
        print "Done! Open decoded_test.ppm to verify the result."
    }
}
